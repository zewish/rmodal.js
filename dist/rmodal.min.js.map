{"version":3,"sources":["rmodal.js"],"names":["const","is","obj","type","Object","prototype","toString","call","toLowerCase","addClass","el","cls","className","split","filter","c","length","removeClass","join","RModal","opts","this","opened","bodyClass","dialogClass","dialogOpenClass","dialogCloseClass","focus","focusElements","escapeClose","content","closeTimeout","keys","forEach","key","undefined","this$1","overlay","dialog","querySelector","open","beforeOpen","_doOpen","document","body","style","display","focusOutElement","activeElement","afterOpen","close","beforeClose","_doClose","setTimeout","afterClose","html","innerHTML","elements","selector","fallback","window","navigator","appVersion","indexOf","querySelectorAll","element","getComputedStyle","visibility","offsetParent","firstChild","keydown","ev","which","stopEvent","preventDefault","stopPropagation","contains","target","first","last","shiftKey","version"],"mappings":"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","file":"rmodal.min.js","sourcesContent":["const is = (obj, type) => Object.prototype.toString.call(obj).toLowerCase() === `[object ${type}]`;\r\n\r\nconst addClass = (el, cls) => {\r\n    const arr = el.className\r\n    .split(/\\s+/)\r\n    .filter((c) => !!c && c == cls);\r\n\r\n    if (!arr.length) {\r\n        el.className += ` ${cls}`;\r\n    }\r\n};\r\n\r\nconst removeClass = (el, cls) => {\r\n    el.className = el.className\r\n    .split(/\\s+/)\r\n    .filter((c) => !!c && c != cls)\r\n    .join(' ');\r\n};\r\n\r\nclass RModal {\r\n    constructor(el, opts) {\r\n        this.opened = false;\r\n\r\n        this.opts = {\r\n            bodyClass: 'modal-open'\r\n            , dialogClass: 'modal-dialog'\r\n            , dialogOpenClass: 'bounceInDown'\r\n            , dialogCloseClass: 'bounceOutUp'\r\n\r\n            , focus: true\r\n            , focusElements: [\r\n                'a[href]', 'area[href]', 'input:not([disabled]):not([type=hidden])'\r\n                , 'button:not([disabled])', 'select:not([disabled])'\r\n                , 'textarea:not([disabled])', 'iframe', 'object', 'embed'\r\n                , '*[tabindex]', '*[contenteditable]'\r\n            ]\r\n\r\n            , escapeClose: true\r\n            , content: null\r\n            , closeTimeout: 500\r\n        };\r\n\r\n        Object.keys(opts || {})\r\n        .forEach((key) => {\r\n            /* istanbul ignore else */\r\n            if (opts[key] !== undefined) {\r\n                this.opts[key] = opts[key];\r\n            }\r\n        });\r\n\r\n        this.overlay = el;\r\n        this.dialog = el.querySelector(`.${this.opts.dialogClass}`);\r\n\r\n        if (this.opts.content) {\r\n            this.content(this.opts.content);\r\n        }\r\n    }\r\n\r\n    open(content) {\r\n        this.content(content);\r\n\r\n        if (!is(this.opts.beforeOpen, 'function')) {\r\n            return this._doOpen();\r\n        }\r\n\r\n        this.opts.beforeOpen(() => {\r\n            this._doOpen();\r\n        });\r\n    }\r\n\r\n    _doOpen() {\r\n        addClass(document.body, this.opts.bodyClass);\r\n\r\n        removeClass(this.dialog, this.opts.dialogCloseClass);\r\n        addClass(this.dialog, this.opts.dialogOpenClass);\r\n\r\n        this.overlay.style.display = 'block';\r\n\r\n        if (this.opts.focus) {\r\n            this.focusOutElement = document.activeElement;\r\n            this.focus();\r\n        }\r\n\r\n        if (is(this.opts.afterOpen, 'function')) {\r\n            this.opts.afterOpen();\r\n        }\r\n        this.opened = true;\r\n    }\r\n\r\n    close() {\r\n        if (!is(this.opts.beforeClose, 'function')) {\r\n            return this._doClose();\r\n        }\r\n\r\n        this.opts.beforeClose(() => {\r\n            this._doClose();\r\n        });\r\n    }\r\n\r\n    _doClose() {\r\n        removeClass(this.dialog, this.opts.dialogOpenClass);\r\n        addClass(this.dialog, this.opts.dialogCloseClass);\r\n\r\n        removeClass(document.body, this.opts.bodyClass);\r\n\r\n        if (this.opts.focus) {\r\n            this.focus(this.focusOutElement);\r\n        }\r\n\r\n        setTimeout(() => {\r\n            this.overlay.style.display = 'none';\r\n\r\n            if (is(this.opts.afterClose, 'function')) {\r\n                this.opts.afterClose();\r\n            }\r\n            this.opened = false;\r\n        }, this.opts.closeTimeout);\r\n    }\r\n\r\n    content(html) {\r\n        if (html === undefined) {\r\n            return this.dialog.innerHTML;\r\n        }\r\n\r\n        this.dialog.innerHTML = html;\r\n    }\r\n\r\n    elements(selector, fallback) {\r\n        fallback = fallback || window.navigator.appVersion.indexOf('MSIE 9.0') > -1;\r\n        selector = is(selector, 'array') ? selector.join(',') : selector;\r\n\r\n        return [].filter.call(\r\n            this.dialog.querySelectorAll(selector)\r\n            , (element) => {\r\n                if (fallback) {\r\n                    const style = window.getComputedStyle(element);\r\n                    return style.display !== 'none' && style.visibility !== 'hidden';\r\n                }\r\n\r\n                return element.offsetParent !== null;\r\n            }\r\n        );\r\n    }\r\n\r\n    focus(el) {\r\n        el = el || this.elements(this.opts.focusElements)[0] || this.dialog.firstChild;\r\n\r\n        if (el && is(el.focus, 'function')) {\r\n            el.focus();\r\n        }\r\n    }\r\n\r\n    keydown(ev) {\r\n        if (this.opts.escapeClose && ev.which == 27) {\r\n            this.close();\r\n        }\r\n\r\n        const stopEvent = () => {\r\n            ev.preventDefault();\r\n            ev.stopPropagation();\r\n        }\r\n\r\n        if (this.opened && ev.which == 9 && this.dialog.contains(ev.target)) {\r\n            const elements = this.elements(this.opts.focusElements)\r\n                , first = elements[0]\r\n                , last = elements[elements.length - 1];\r\n\r\n            if (first == last) {\r\n                stopEvent();\r\n            }\r\n            else if (ev.target == first && ev.shiftKey) {\r\n                stopEvent();\r\n                last.focus();\r\n            }\r\n            else if (ev.target == last && !ev.shiftKey) {\r\n                stopEvent();\r\n                first.focus();\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nRModal.prototype.version = '@@VERSION@@';\r\nRModal.version = '@@VERSION@@';\r\n\r\nexport default RModal;\r\n"]}